<!DOCTYPE html>
<html
        xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <title>登录</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport"/>
    <!-- Bootstrap 3.3.6 -->
    <link rel="stylesheet" href="resources/plugins/bootstrap/css/bootstrap.min.css"/>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="resources/plugins/font-awesome-4.7.0/css/font-awesome.min.css"/>
    <!-- Ionicons -->
    <link rel="stylesheet" href="resources/plugins/ionicons-2.0.1/css/ionicons.min.css"/>
    <!-- Theme style -->
    <link rel="stylesheet" href="resources/plugins/AdminLTE/css/AdminLTE.css"/>
    <!-- iCheck -->
    <link rel="stylesheet" href="resources/plugins/iCheck/square/blue.css"/>
    <link rel="stylesheet" href="resources/plugins/sweetalert/sweetalert.css"/>
    <link rel="stylesheet" href="resources/plugins/pace/pace.min.css"/>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="resources/plugins/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="resources/plugins/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body class="hold-transition login-page">
<div class="login-box">
    <div class="login-logo">
        <a href="/login"><b>资产</b>管理平台</a>
    </div>
    <!-- /.login-logo -->
    <div class="login-box-body">
        <p class="login-box-msg">后台登录</p>
        <form id="validateform">
            <div class="form-group has-feedback">
                <span class="glyphicon glyphicon-user form-control-feedback"></span>
                <input type="text" class="form-control" placeholder="账户" id="name" name="name" th:value="${account}"/>
            </div>
            <div class="form-group has-feedback">
                <span class="glyphicon glyphicon-lock form-control-feedback"></span>
                <input type="password" class="form-control" placeholder="密码" id="password" name="password"
                       th:value="${password}"/>
            </div>
            <div class="row">
                <div class="col-xs-8">
                    <div class="checkbox icheck">
                        <label>
                            <input type="checkbox" id="remember"/> 记住我
                        </label>
                    </div>
                </div>

                <!-- /.col -->
                <div class="col-xs-4">
                    <button type="button" class="btn btn-primary btn-block btn-flat" id="login">登录</button>
                </div>
                <!-- /.col -->
            </div>
        </form>

        <!-- /.social-auth-links -->

        <a href="javascript:;">忘记密码，请联系管理员</a><br/>
        <!-- 你可以直接在 HTML 元素中绑定 showPanel -->
        <a href="javascript:void(0)" onclick="_MEIQIA('showPanel')">联系客服</a>

        <script type='text/javascript'>
            (function(m, ei, q, i, a, j, s) {
                m[i] = m[i] || function() {
                    (m[i].a = m[i].a || []).push(arguments)
                };
                j = ei.createElement(q),
                    s = ei.getElementsByTagName(q)[0];
                j.async = true;
                j.charset = 'UTF-8';
                j.src = 'https://static.meiqia.com/dist/meiqia.js?_=t';
                s.parentNode.insertBefore(j, s);
            })(window, document, 'script', '_MEIQIA');
            _MEIQIA('entId', 96105);
            _MEIQIA('withoutBtn');
        </script>
        <!-- 当然也可以在 Javascript 中调用 -->
        <!--<script>-->
            <!--_MEIQIA('showPanel');-->
        <!--</script>-->

        <!-- 当然也可以在 Javascript 中调用 -->
        <!--<script type='text/javascript'>-->
            <!--// 当你使用了「手动初始化」时，就可以在自己的逻辑中选择合适的时机调用 withoutBtn-->
            <!--// 只要是在美洽初始化之前，就可以被正确执行-->
            <!--_MEIQIA('withoutBtn');-->
            <!--_MEIQIA('init');-->
        <!--</script>-->

    </div>

    <!-- /.login-box-body -->
</div>
<!-- 这是美洽的嵌入代码 -->

<!-- /.login-box -->

<!-- jQuery 2.2.3 -->
<script src="resources/plugins/jQuery/jquery-2.2.3.min.js"></script>
<!-- Bootstrap 3.3.6 -->
<script src="resources/plugins/bootstrap/js/bootstrap.min.js"></script>
<!-- iCheck -->
<script src="resources/plugins/iCheck/icheck.min.js"></script>
<script src="resources/plugins/sweetalert/sweetalert.min.js"></script>
<script src="resources/plugins/jquery-validation/dist/jquery.validate.min.js"></script>
<script src="resources/plugins/jquery-validation/dist/localization/messages_zh.js"></script>
<script src="resources/plugins/pace/pace.min.js"></script>
<!--<script src="https://cdn.jsdelivr.net/sockjs/1/sockjs.min.js"></script>-->
<script src="resources/plugins/stomp/stomp.min.js"></script>
<!--<script src='//kefu.easemob.com/webim/easemob.js?configId=2c00605d-7f48-428e-92b3-802d2e7f4efb'></script>-->
<script src="https://qiyukf.com/script/2cb3dde4d616c89788ba73ed76da48f8.js"></script>
<script type="text/javascript">
    window.openSDK = function(){
        ysf.open({
            templateId: 123//此处id对应样式模板id,配置不同的模板id,打开的窗口样式不一样，欢迎语也不一样
        });
    }
</script>
</body>
<script>
    /*<![CDATA[*/
    $(document).ajaxStart(function () {
        Pace.restart();
    })
    $(function () {

        $('input').iCheck({
            checkboxClass: 'icheckbox_square-blue',
            radioClass: 'iradio_square-blue',
            increaseArea: '20%' // optional
        });

    });

    $(function () {
        if ($("#name").val() != "" && $("#name").val != null && $("#password").val() != "" &&  $("#password").val() != null) {
            $('#remember').iCheck('check');
        }
    });

    //编写表单验证函数validform，在验证按钮注册按钮点击事件内调用验证函数对象
    function validform() {
        return $("#validateform").validate({
            rules: {
                name: {
                    required: true
                },
                password: {
                    required: true
                }
            },
            messages: {
                name: {
                    required: '<label class="control-label text-danger">请输入用户名</label>',
                },
                password: {
                    required: '<label class="control-label text-danger">请输入密码</label>',
                }
            }
        });
    }
    //注册表单验证
    $(validform());
    //以上部分已经实现匿名函数的作用，下面介绍如何通过普通按钮实现表单验证
    $("#login").click(function () {
        if (validform().form()) {
            //通过表单验证，以下编写自己的代码
            var name = $("#name").val();
            var password = $("#password").val();
            var remember = $("input[type='checkbox']").is(':checked')
            $.ajax({
                url: "user/login",
                data: {
                    "name": name,
                    "password": password,
                    "remember": remember
                },
                type: "post",
                dataType: "json",
                success: function (data) {
                      console.log(data);
                    if (data.state == 1) {
                        location.href = "dashboard";
                    } else {
                        $("#password").parent().find("label").remove()
                        $("#password").after('<label class="control-label text-danger">用户名或密码错误</label>')
                    }
                }
            });
        } else {
            //校验不通过，什么都不用做，校验信息已经正常显示在表单上
        }
    });

    /*]]>*/
</script>

</html>
